# Market Simulator

A high-performance financial-market simulator written in Rust for designing, training, and evaluating trading agents—classical or reinforcement-learning based—under realistic limit-order-book conditions.

---

## Overview

* **Performance and safety** – implemented in pure safe Rust; core hot-loop runs in the low-microsecond range on commodity hardware.
* **Exchange-grade mechanics** – price-time FIFO matching, partial fills, cancels, and multi-level sweeps.
* **Pluggable architecture** – the engine is packaged as a reusable crate; agents implement a minimal `Agent` trait and can be injected at runtime.
* **Synthetic yet realistic data** – includes generators for price paths (GBM) and on-chain option fair-value curves (Black–Scholes) to drive order-flow scenarios.
* **Batteries included** – unit tests for edge cases, Criterion benchmarks, and an egui visualizer for quick inspection.

---

## Project Milestones

| Phase                    | Description                                                     | Status       |
| :----------------------- | :-------------------------------------------------------------- | :----------- |
| **0 – Foundation** | Repository scaffolding, CI, basic crate layout                  | **Complete** |
| **1 – Single-Asset Price Path** | Geometric Brownian Motion time series                           | **Complete** |
| **2 – Fair Option Pricing** | Black–Scholes model (price and Greeks)                          | **Complete** |
| **3 – Order-Book Dynamics** | Iterative price-level generation and matching engine            | **Complete** |
| **4 – Market Participants** | Ensemble of agents (market makers, whales, dumb flow)           | *Satisfactory* |
| **5 – RL Bridge** | Streaming interface (ZeroMQ / gRPC) for external policy control | Deferred/Sep Project      |
| **6 – Multi-Asset Support** | Per-symbol sharded books, cross-asset interaction               | **Complete**      |
| **7 – OrderBook Options** | Options Pricing and trades, separate Options Market               | Planned      |

---

## Quick Performance Snapshot

*50 000 resting orders, 25 000-share market sweep*
Apple M1 Pro, single core, Rust 1.87 release profile:

```
time:   [38.8 µs 40.1 µs 41.3 µs]   (Criterion, 50 samples)
throughput:  1.26 G order-ops·s⁻¹
```

*1 000 000 resting orders, 100 000 sweep*:

```
time:   [2.72 ms 2.85 ms 2.98 ms]
```

These figures include order-book construction; pure matching latency is lower.

---

## Directory Structure

```
src/
├─ agents/              ─ reference agent implementations
├─ simulators/
│  ├─ order_book.rs     ─ matching engine
│  └─ gbm.rs            ─ price-path generator
├─ pricing/             ─ Black–Scholes utilities
├─ market.rs            ─ world state and main tick loop
└─ lib.rs               ─ crate entry point
benches/                ─ Criterion benchmarks
bin/
├─ visual_order.rs      ─ egui order-book visualizer
└─ visualizer.rs        ─ GBM + option-price demo
```

---

## Building

```bash
cargo build --release
```

---

## Running Benchmarks (short CI profile)

```bash
cargo bench --bench order_book -- --sample-size 30 --measurement-time 6
```

---



---

Further details, API documentation, and benchmark reports are generated by `cargo doc --no-deps` and live under `target/doc` or via GitHub Pages if enabled.